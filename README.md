# AIタイトル生成システム - Electronデスクトップアプリケーション

商品画像からAIが最適な出品タイトルを生成するデスクトップアプリケーションです。

## 🌟 機能概要

### 新しいタブ型インターフェース
本アプリケーションは3つのメインタブで構成されています：

1. **入力タブ** - 単体画像処理と商品情報入力
2. **一括処理タブ** - ディレクトリから大量画像の自動処理
3. **結果タブ** - 処理結果の表示とCSV出力

### 現場作業フロー対応
1. **撮影** - 商品の撮影
2. **リネーム** - 保有撮影アプリで画像名を管理番号にリネーム
3. **生成** - 生成システムで以下のランクに分類
   - **ランクA**: 成功（文字数規定以上）
   - **ランクB**: 成功（文字数規定以下）
   - **ランクC**: 失敗
4. **自動カテゴリ選択** - ABランクはタイトル文字から自動選択
5. **出力** - 指定マクロ書式で出力

### 主要機能
- ✅ **タブ型UI** - 入力、一括処理、結果の3タブ構成
- ✅ **ドラッグ&ドロップ** - 画像の直感的なアップロード
- ✅ **商品情報入力** - ブランド、サイズ、型番等の事前入力
- ✅ **一括処理** - 最大5000点の商品を自動処理
- ✅ **リアルタイム統計** - ランク別処理結果の表示
- ✅ **CSV出力** - ランク別・エラーログの出力
- ✅ **設定管理** - 文字数規定、バックエンドURL等の設定

## 🎨 UI構成

### 入力タブ
- **商品画像アップロード**: ドラッグ&ドロップまたはファイル選択（最大10枚）
- **商品情報入力**: ブランド、型番、サイズ、追加情報の入力フォーム
- **スケール設定**: 測定スケール含有の設定
- **アプリケーション設定**: バックエンドURL、文字数規定等

### 一括処理タブ
- **ディレクトリ選択**: 画像フォルダの一括選択
- **処理フロー説明**: 現場作業流れの詳細説明
- **ランクシステム**: A/B/Cランクの判定基準
- **バッチ処理開始**: 最大5000点の自動処理

### 結果タブ
- **統計ダッシュボード**: 総処理数、ランク別件数、成功/エラー数
- **処理結果一覧**: 詳細な処理結果とステータス表示
- **CSV出力機能**: ランク別・エラーログの出力

## 🚀 クイックスタート

### 開発環境の起動（Windows）
```bash
# 開発サーバーを起動
start-dev.bat
```

### 本番ビルド（Windows）
```bash
# インストーラーを作成
build-production.bat
```

## 📦 セットアップ手順

### 前提条件
- Node.js (v16以上)
- npm または yarn  
- Windows 10/11 (推奨)

### 1. 依存関係のインストール
```bash
npm install --legacy-peer-deps
```

### 2. 環境変数の設定
`.env`ファイルを作成：
```env
REACT_APP_BACKEND_URL=http://localhost:8000
```

### 3. 開発モードでの起動
```bash
# React開発サーバーを起動
npm start

# 別のターミナルでElectronを起動  
npm run electron-dev
```

### 4. 本番ビルド
```bash
# アプリケーションをビルド
npm run build

# Windowsインストーラーを作成
npm run dist-win
```

## 📖 使用方法

### 基本操作（単体処理）
1. **入力タブ**を開く
2. 商品画像をドラッグ&ドロップまたは選択
3. 既知の商品情報を入力（任意）
4. **「タイトルを生成」**ボタンをクリック
5. **結果タブ**で生成されたタイトルを確認

### 一括処理操作
1. **一括処理タブ**を開く
2. 画像ディレクトリを選択
3. **「一括処理を開始」**ボタンをクリック
4. **結果タブ**で全ての処理結果を確認
5. 必要に応じてCSVファイルをエクスポート

### CSV出力
- **ランク別出力**: A/B/Cランクごとの個別CSV
- **エラーログ**: 失敗した商品の蓄積型ログ
- **自動ファイル名**: 年月日_ランク{A|B|C}_{件数}件.csv

## 🛠️ 技術仕様

### アーキテクチャ
```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   React App     │    │  Electron Main   │    │   Backend API   │
│   (Renderer)    │◄──►│    Process       │◄──►│   (External)    │
│  ┌─────────────┐ │    │                  │    └─────────────────┘
│  │入力タブ     │ │    │ ┌──────────────┐ │
│  │一括処理タブ │ │    │ │ IPC通信      │ │
│  │結果タブ     │ │    │ │ ファイル操作 │ │
│  └─────────────┘ │    │ │ CSV出力      │ │
└─────────────────┘    │ └──────────────┘ │
                       └──────────────────┘
```

### 技術スタック
- **フロントエンド**: React 18, TypeScript, Tailwind CSS
- **デスクトップ**: Electron 28
- **UI コンポーネント**: Radix UI, Lucide React
- **ビルドツール**: React Scripts, Electron Builder

### UIコンポーネント構成
```
App.tsx
├── Tabs (入力/一括処理/結果)
│   ├── 入力タブ
│   │   ├── ImageUploader (画像アップロード)
│   │   ├── 商品情報入力フォーム
│   │   └── SettingsPanel (設定パネル)
│   ├── 一括処理タブ
│   │   └── BatchProcessor (バッチ処理)
│   └── 結果タブ
│       ├── 統計ダッシュボード
│       ├── ResultsDisplay (結果表示)
│       └── CSVExporter (CSV出力)
└── LoadingSpinner (全画面ローディング)
```

## 🎯 ランクシステム

| ランク | 条件 | 説明 | 自動アクション |
|-------|------|------|---------------|
| **A** | 文字数規定達成 | 生成成功、十分な文字数 | カテゴリ自動選択 |
| **B** | 文字数規定未達成 | 生成成功、文字数不足 | カテゴリ自動選択 + 手動確認推奨 |
| **C** | 生成失敗 | タイトル生成失敗 | エラーログ出力 + 人間による作成必要 |

## 🔧 開発情報

### 利用可能なコマンド
```bash
npm start              # React開発サーバー起動
npm run electron-dev   # Electron開発モード起動
npm run build-react    # Reactアプリビルド
npm run build-electron # Electronメインプロセスビルド
npm run build          # 全体ビルド
npm run dist-win       # Windows配布パッケージ作成
```

### API仕様
```typescript
// タイトル生成API
POST /api/generate-title
{
  "product_images": ["base64..."],
  "has_scale": true,
  "brand": "ユニクロ",
  "model_number": "ABC123", 
  "size": "M",
  "additional_info": "追加情報",
  "product_id": "管理番号",
  // その他のパラメータ...
}
```

## 📊 出力ファイル仕様

### CSV出力形式
- **ランク別CSV**: `YYYYMMDD_ランク{A|B|C}_{件数}件.csv`
- **エラーログ**: `error_log.csv` (蓄積型)
- **保存場所**: `ドキュメント/AIタイトル生成システム/`

### CSVカラム構成
```csv
管理番号,タイトル,ブランド,カテゴリ,サイズ,文字数,ランク,処理時間,生成日時
```

### エラーログ構成
```csv
管理番号,生成途中データ,失敗理由,読み込み年月日
```

## 🔧 トラブルシューティング

### よくある問題

**Q: 依存関係のインストールエラー**
```bash
npm install --legacy-peer-deps --force
```

**Q: TypeScript コンパイルエラー**
- `tsconfig.json`の`target`を`es2015`以上に設定済み
- `downlevelIteration: true`で Map/Set イテレーション対応済み

**Q: Electronが起動しない**
```bash
# Electronの再インストール
npm uninstall electron
npm install electron@28.0.0 --save-dev
```

**Q: 画像アップロードが機能しない**
- ファイルサイズは5MB以下に制限
- 対応形式: JPG, PNG, GIF, BMP, WebP
- デスクトップ版ではElectronの native dialogを使用

**Q: 一括処理でエラーが発生する**
- ファイル名に13桁の管理番号が含まれているか確認
- ディレクトリへの読み取り権限を確認
- 最大5000ファイルまでの制限を確認

## 📝 開発状況

### ✅ 完了済み機能
- [x] Electronアプリケーション基盤
- [x] タブ型React UIインターフェース
- [x] 画像アップロード機能（ドラッグ&ドロップ対応）
- [x] 商品情報入力フォーム
- [x] タイトル生成API連携
- [x] ランクシステム実装
- [x] 一括処理機能
- [x] CSV出力機能（ランク別・エラーログ）
- [x] リアルタイム統計表示
- [x] 設定管理機能
- [x] ファイル選択・保存機能

### 🔮 今後の予定
- [ ] 採寸機能の統合（第二開発フェーズ）
- [ ] パフォーマンス最適化
- [ ] テストカバレッジ向上
- [ ] 多言語対応（英語）

---

**Version**: 1.0.0  
**Electron**: v28.0.0  
**React**: v18.2.0  
**Build**: Production Ready ✅

**Last Updated**: タブ型UI実装完了 - オリジナルフロントエンドのUIデザインに準拠 